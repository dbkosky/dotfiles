#! /bin/sh

pgrep -x sxhkd > /dev/null || sxhkd &

# MONITOR SETUP
monitors=$(bspc query -M --names)

TOP=("HDMI-A-0","DisplayPort-1")
BOTTOM=("eDP")

available_top=()
available_bottom=()

for value in $monitors
do
    if [[ ${TOP[*]} =~ $value ]]; then
        available_top+=("$value")
        echo $value
    fi
    if [[ ${BOTTOM[*]} =~ $value ]]; then
        available_bottom+=("$value")
    fi
done

if [ "${#available_top[@]}" -eq "1" ] && [ "${#available_bottom[@]}" -eq "1" ]; then
    BOTTOM=${available_bottom[0]}
    TOP=${available_top[0]}
    # xrandr --output $TOP --above $BOTTOM
    bspc monitor $TOP -d 6 7 8 9 10
    bspc monitor $BOTTOM -d 1 2 3 4 5
    bspc wm -O $BOTTOM $TOP
    MONITOR=$TOP polybar top &
    MONITOR=$BOTTOM polybar top &
else
    bspc monitor eDP -d 1 2 3 4 5 6 7 8 9 10
    polybar top &
fi



bspc config border_width         2
bspc config window_gap           8

bspc config split_ratio          0.52
bspc config borderless_monocle   true
bspc config gapless_monocle      true

bspc rule -a Gimp desktop='^8' state=floating follow=on
bspc rule -a Chromium desktop='^2'
bspc rule -a mplayer2 state=floating
bspc rule -a Kupfer.py focus=on
bspc rule -a Screenkey manage=off
bspc rule -a Emacs state=tiled
